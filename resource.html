<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Resource • iLRN XR Repository</title>
  <style>
    :root{
      --bg:#ffffff; --text:#0b1a33; --muted:#5d6c84; --primary:#1f4aa8; --border:#dbe3f1; --card:#f7f9fc; --chip:#e9efff;
    }
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; margin:0; background:var(--bg); color:var(--text);}
    .wrap{max-width:900px; margin:0 auto; padding:22px 16px 60px;}
    a{color:#1f4aa8; text-decoration:none} a:hover{text-decoration:underline}
    header{border-bottom:1px solid var(--border); background:linear-gradient(180deg,#fff,#f8fbff);}
    .title{font-size:24px; margin:0 0 6px; color:var(--primary)}
    .meta{color:var(--muted); font-size:14px}
    .card{background:#fff; border:1px solid var(--border); border-radius:14px; padding:18px; margin-top:16px}
    .grid{display:grid; grid-template-columns:180px 1fr; gap:8px 18px}
    .label{color:var(--muted)}
    .chips span{display:inline-block;background:var(--chip);border:1px solid var(--border);padding:4px 8px;border-radius:999px;margin-right:6px;margin-bottom:6px}
    .back{display:inline-block;margin-top:10px}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <a class="back" href="index.html">← Back to list</a>
      <h1 class="title" id="title">Resource</h1>
      <div class="meta" id="subtitle"></div>
    </div>
  </header>
  <main class="wrap">
    <div class="card">
      <div class="grid">
        <div class="label">Publication Date</div><div id="date">—</div>
        <div class="label">Category</div><div id="cat">—</div>
        <div class="label">Platform</div><div id="plat" class="chips">—</div>
        <div class="label">Resource Type</div><div id="type">—</div>
        <div class="label">Target Age Group</div><div id="age">—</div>
        <div class="label">Description</div><div id="desc">—</div>
        <div class="label">URL</div><div id="link">—</div>
      </div>
    </div>
  </main>

  <script>
    const DATA_URL = './data/resources.json?t=' + Date.now();

    function slugify(s){ return String(s||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,''); }
    const params = new URLSearchParams(location.search);
    const id = params.get('id');

    async function load(){
      const res = await fetch(DATA_URL, {cache:'no-store'});
      const items = await res.json();
      let item = null;

      // match by slug of title or fallback by index/id
      for (let i=0;i<items.length;i++){
        const r = items[i];
        if (slugify(r.title||r["Resource Name"]) === id || String(i)===id || String(r.id||'')===id){
          item = r; break;
        }
      }
      if(!item){ document.getElementById('title').textContent = 'Not found'; return; }

      const r = {
        title: item.title || item["Resource Name"] || "Untitled",
        description: item.description || item["Description"] || "",
        category: item.category || item["Category"] || "",
        target_age_group: item.target_age_group || item["Target Age Group"] || "",
        resource_type: item.resource_type || item["Resource Type"] || "",
        language: item.language || item["Language"] || "",
        url: item.url || item["URL"] || "",
        platform: item.platform || item["Platform"] || "",
        publication_date: item.publication_date || item["Publication Date"] || ""
      };

      document.getElementById('title').textContent = r.title;
      document.getElementById('subtitle').textContent = r.resource_type || '';
      document.getElementById('desc').textContent = r.description || '—';
      document.getElementById('cat').textContent = r.category || '—';
      document.getElementById('age').textContent = r.target_age_group || '—';
      document.getElementById('type').textContent = r.resource_type || '—';
      document.getElementById('date').textContent = r.publication_date || '—';

      // platform can be string or array
      const plat = Array.isArray(r.platform) ? r.platform : String(r.platform||'').split(',').map(s=>s.trim()).filter(Boolean);
      document.getElementById('plat').innerHTML = plat.length ? plat.map(p=>`<span>${p}</span>`).join(' ') : '—';

      document.getElementById('link').innerHTML = r.url ? `<a href="${r.url}" target="_blank" rel="noopener">${r.url}</a>` : '—';
    }

    load();
  </script>
</body>
</html>
